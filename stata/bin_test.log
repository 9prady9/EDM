
. 
. set linesize 255

. //set obs 500
. set obs 500
number of observations (_N) was 0, now 500

. set seed 12345678

. if c(MP) {
.     qui set processor 1
. }

. 
. global EDM_VERBOSITY=1

. global EDM_NTHREADS=4

. 
. gen t = _n

. tsset t
        time variable:  t, 1 to 500
                delta:  1 unit

. 
. gen double x = 0.2 if _n==1
(499 missing values generated)

. gen double y = 0.4 if _n==1
(499 missing values generated)

. gen double z = 0.15 if _n==1
(499 missing values generated)

. 
. * Create a dynamic system
. local r_x 3.625

. local r_y 3.77

. local beta_xy = 0.05

. local beta_yx=0.4

. local tau = 1

. drawnorm double u1 u2

. qui {

. 
. 
. * Create binary variables
. replace x=1 if abs(x) > 0.5
(343 real changes made)

. replace x=0 if abs(x) <= 0.5
(157 real changes made)

. 
. replace y=1 if abs(y) > 0.65
(244 real changes made)

. replace y=0 if abs(y) <= 0.65
(256 real changes made)

. 
. //qui {
. //  levelsof x
. //}
. 
. //display "Distinct values in x: " r(r)
. 
. //* burn the first 300 observations
. //keep in 300/500
. 
. * Determining the complexity of the system
. 
. //edm explore x, algorithm(smap)
. //
. //edm explore x, copredict(teste) copredictvar(y)
. //assert teste!=. if _n>1
. 
. //edm xmap x y, algorithm(smap)
. 
. edm xmap x y, copredict(teste) copredictvar(z y) algorithm(smap)

====================
Start of the plugin

number of vars & obs = 7, 500
first and last obs in sample = 1, 500

arg 0: 1
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: binary
arg 12: binary

theta = 1.0000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

manifold metric = binary

train set obs: 499
predict set obs: 499

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads


End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 500
first and last obs in sample = 1, 500

arg 0: 1
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: binary
arg 12: binary

theta = 1.0000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

manifold metric = binary

train set obs: 499
predict set obs: 499

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads


End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 9, 500
first and last obs in sample = 1, 500

arg 0: 1
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 1
arg 7: 0
arg 8: 2
arg 9: 4
arg 10: 1
arg 11: binary
arg 12: euclidean

theta = 1.0000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

manifold metric = binary

train set obs: 499
predict set obs: 499

p_manifold flag = true
number of variables in p_manifold = 2
p_manifold metric = euclidean


l = 4

save_mode = false

Requested 4 threads
Using 4 threads


End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables x and y
---------------------------------------------------------------
      Mapping    Library size             rho             MAE
---------------------------------------------------------------
   y ~ y|M(x)             499        -.032749          .50501 
   x ~ x|M(y)             499          .17056          .46994 
---------------------------------------------------------------
Note: The embedding dimension E is 2

. 
. cap log close _all
