
. 
. set linesize 255

. set obs 500
number of observations (_N) was 0, now 500

. set seed 12345678

. if c(MP) {
.     qui set processor 1
. }

. 
. global EDM_VERBOSITY=1

. global EDM_NTHREADS=4

. 
. gen t = _n

. tsset t
        time variable:  t, 1 to 500
                delta:  1 unit

. 
. gen double x = 0.2 if _n==1
(499 missing values generated)

. gen double y = 0.4 if _n==1
(499 missing values generated)

. 
. * Create a dynamic system
. local r_x 3.625

. local r_y 3.77

. local beta_xy = 0.05

. local beta_yx=0.4

. local tau = 1

. drawnorm double u1 u2

. qui {

. 
. * burn the first 300 observations
. keep in 300/500
(299 observations deleted)

. 
. * Determining the complexity of the system
. 
. * identify optimal E
. edm explore x, e(2/10) saveinputs(test1.h5)

Number of distinct values in manifold: 201
Manifold metric: euclidean

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: euclidean
arg 12: euclidean
arg 13: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

manifold metric = euclidean

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads


End of the plugin
====================


Number of distinct values in manifold: 201
Manifold metric: euclidean

====================
Start of the plugin

number of vars & obs = 8, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 4
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 3
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: euclidean
arg 12: euclidean
arg 13: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 3

manifold metric = euclidean

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads


End of the plugin
====================


Number of distinct values in manifold: 201
Manifold metric: euclidean

====================
Start of the plugin

number of vars & obs = 9, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 4
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: euclidean
arg 12: euclidean
arg 13: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 4

manifold metric = euclidean

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads


End of the plugin
====================


Number of distinct values in manifold: 201
Manifold metric: euclidean

====================
Start of the plugin

number of vars & obs = 10, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 6
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 5
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: euclidean
arg 12: euclidean
arg 13: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 5

manifold metric = euclidean

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 6

save_mode = false

Requested 4 threads
Using 4 threads


End of the plugin
====================


Number of distinct values in manifold: 201
Manifold metric: euclidean

====================
Start of the plugin

number of vars & obs = 11, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 7
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 6
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: euclidean
arg 12: euclidean
arg 13: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 6

manifold metric = euclidean

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 7

save_mode = false

Requested 4 threads
Using 4 threads


End of the plugin
====================


Number of distinct values in manifold: 201
Manifold metric: euclidean

====================
Start of the plugin

number of vars & obs = 12, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 8
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 7
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: euclidean
arg 12: euclidean
arg 13: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 7

manifold metric = euclidean

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 8

save_mode = false

Requested 4 threads
Using 4 threads


End of the plugin
====================


Number of distinct values in manifold: 201
Manifold metric: euclidean

====================
Start of the plugin

number of vars & obs = 13, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 9
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 8
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: euclidean
arg 12: euclidean
arg 13: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 8

manifold metric = euclidean

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 9

save_mode = false

Requested 4 threads
Using 4 threads


End of the plugin
====================


Number of distinct values in manifold: 201
Manifold metric: euclidean

====================
Start of the plugin

number of vars & obs = 14, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 10
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 9
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: euclidean
arg 12: euclidean
arg 13: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 9

manifold metric = euclidean

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 10

save_mode = false

Requested 4 threads
Using 4 threads


End of the plugin
====================


Number of distinct values in manifold: 201
Manifold metric: euclidean

====================
Start of the plugin

number of vars & obs = 15, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 11
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 10
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: euclidean
arg 12: euclidean
arg 13: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 10

manifold metric = euclidean

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 11

save_mode = false

Requested 4 threads
Using 4 threads


End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with x and its lag values
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1          .99838         .008126 
                 3               1          .99777          .01015 
                 4               1          .99726         .011441 
                 5               1          .99707         .012625 
                 6               1          .99397          .01607 
                 7               1          .99222         .018344 
                 8               1          .98998         .021055 
                 9               1          .98896         .022099 
                10               1          .98566          .02446 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Random 50/50 split for training and validation data

. 
. edm xmap x y, k(5)
edm plugin call requires 11 or 12 arguments
r(102);

end of do-file

r(102);

. prog drop edm

. do bin_test.do

. clear

. 
. cap log close _all
