

. clear

. 
. set linesize 255

. set obs 500
number of observations (_N) was 0, now 500

. set seed 12345678

. if c(MP) {
.     qui set processor 1
. }

. 
. global EDM_VERBOSITY=1

. global EDM_NTHREADS=4

. 
. gen t = _n

. tsset t
        time variable:  t, 1 to 500
                delta:  1 unit

. 
. gen double x = 0.2 if _n==1
(499 missing values generated)

. gen double y = 0.4 if _n==1
(499 missing values generated)

. 
. * Create a dynamic system
. local r_x 3.625

. local r_y 3.77

. local beta_xy = 0.05

. local beta_yx=0.4

. local tau = 1

. drawnorm double u1 u2

. qui {

. 
. * burn the first 300 observations
. keep in 300/500
(299 observations deleted)

. 
. * Determining the complexity of the system
. 
. * identify optimal E
. edm explore x, e(2/10) saveinputs(test1.h5)

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Resizing thread pool from 0 to 4 threads
Calculating distances
...........
Distances calculated
Waited 0.3079 ms
Making predictions
...........
Predictions made
Waited 0.2639 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 8, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 4
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 3
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 3

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1931 ms
Making predictions
...........
Predictions made
Waited 0.2645 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 9, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 4
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 4

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2843 ms
Making predictions
...........
Predictions made
Waited 0.2435 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 10, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 6
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 5
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 5

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 6

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2622 ms
Making predictions
...........
Predictions made
Waited 0.2922 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 11, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 7
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 6
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 6

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 7

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.3421 ms
Making predictions
...........
Predictions made
Waited 0.2348 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 12, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 8
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 7
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 7

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 8

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2667 ms
Making predictions
...........
Predictions made
Waited 0.3153 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 13, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 9
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 8
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 8

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 9

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.348 ms
Making predictions
...........
Predictions made
Waited 0.2753 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 14, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 10
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 9
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 9

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 10

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.3256 ms
Making predictions
...........
Predictions made
Waited 0.2836 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 15, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 11
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 10
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1
arg 11: test1.h5

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 10

train set obs: 95
predict set obs: 96

p_manifold flag = false

l = 11

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.3545 ms
Making predictions
...........
Predictions made
Waited 0.2062 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with x and its lag values
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1          .99838         .008126 
                 3               1          .99777          .01015 
                 4               1          .99726         .011441 
                 5               1          .99707         .012625 
                 6               1          .99397          .01607 
                 7               1          .99222         .018344 
                 8               1          .98998         .021055 
                 9               1          .98896         .022099 
                10               1          .98566          .02446 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Random 50/50 split for training and validation data

. 
. edm xmap x y, k(5)

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 200
predict set obs: 200

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.5897 ms
Making predictions
..........
Predictions made
Waited 0.2377 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 200
predict set obs: 200

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.3732 ms
Making predictions
..........
Predictions made
Waited 0.4011 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables x and y
---------------------------------------------------------------
      Mapping    Library size             rho             MAE
---------------------------------------------------------------
   y ~ y|M(x)             200          .55861          .12802 
   x ~ x|M(y)             200          .94454         .048853 
---------------------------------------------------------------
Note: Number of neighbours (k) is adjusted to 5
Note: The embedding dimension E is 2

. 
. edm xmap x y, e(6) lib(8) 

====================
Start of the plugin

number of vars & obs = 11, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 7
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 6
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 6

train set obs: 8
predict set obs: 196

p_manifold flag = false

l = 7

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.3899 ms
Making predictions
...........
Predictions made
Waited 0.2459 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 11, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 7
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 6
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 6

train set obs: 8
predict set obs: 196

p_manifold flag = false

l = 7

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.4476 ms
Making predictions
...........
Predictions made
Waited 0.4412 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables x and y
---------------------------------------------------------------
      Mapping    Library size             rho             MAE
---------------------------------------------------------------
   y ~ y|M(x)               8          .34074          .15729 
   x ~ x|M(y)               8           .5642          .16437 
---------------------------------------------------------------
Note: The embedding dimension E is 6

. 
. edm explore x, k(5) crossfold(10)
10-fold cross-validation progress (10 in total)

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 180
predict set obs: 19

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...................
Distances calculated
Waited 0.3103 ms
Making predictions
...................
Predictions made
Waited 0.1153 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 179
predict set obs: 20

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1002 ms
Making predictions
..........
Predictions made
Waited 0.1039 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 179
predict set obs: 20

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1142 ms
Making predictions
..........
Predictions made
Waited 0.1076 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 179
predict set obs: 20

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1881 ms
Making predictions
..........
Predictions made
Waited 0.1008 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 179
predict set obs: 20

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1125 ms
Making predictions
..........
Predictions made
Waited 0.1187 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 179
predict set obs: 20

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1244 ms
Making predictions
..........
Predictions made
Waited 0.0892 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 179
predict set obs: 20

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1282 ms
Making predictions
..........
Predictions made
Waited 0.1006 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 179
predict set obs: 20

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1097 ms
Making predictions
..........
Predictions made
Waited 0.1146 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 179
predict set obs: 20

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.0857 ms
Making predictions
..........
Predictions made
Waited 0.1203 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 179
predict set obs: 20

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1075 ms
Making predictions
..........
Predictions made
Waited 0.0763 ms
Saving predictions

End of the plugin
====================

.

Empirical Dynamic Modelling
Univariate mapping with x and its lag values
----------------------------------------------------------------------
                      --------- rho ---------  --------- MAE ---------
 Actual E    theta         Mean    Std. Dev.         Mean    Std. Dev.
----------------------------------------------------------------------
        2        1       .99939    .00028279     .0051435     .0012207
----------------------------------------------------------------------
Note: Results from 10 runs
Note: Number of neighbours (k) is adjusted to 5
Note: 10-fold cross validation results reported

. 
. edm explore x, theta(0.2(0.1)2.0) algorithm(smap)

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: .2
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 0.2000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.2456 ms
Making predictions
..........
Predictions made
Waited 0.1875 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: .3
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 0.3000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.2086 ms
Making predictions
..........
Predictions made
Waited 0.3613 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: .4
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 0.4000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1745 ms
Making predictions
..........
Predictions made
Waited 0.3701 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: .5
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 0.5000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1706 ms
Making predictions
..........
Predictions made
Waited 0.3306 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: .6
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 0.6000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.17 ms
Making predictions
..........
Predictions made
Waited 0.2594 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: .7
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 0.7000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1849 ms
Making predictions
..........
Predictions made
Waited 0.3352 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: .8
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 0.8000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1682 ms
Making predictions
..........
Predictions made
Waited 0.316 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: .9
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 0.9000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.2844 ms
Making predictions
..........
Predictions made
Waited 0.3058 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1899 ms
Making predictions
..........
Predictions made
Waited 0.2335 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1.1
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.1000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1969 ms
Making predictions
..........
Predictions made
Waited 0.3118 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1.2
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.2000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1782 ms
Making predictions
..........
Predictions made
Waited 0.2097 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1.3
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.3000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.169 ms
Making predictions
..........
Predictions made
Waited 0.2201 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1.4
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.4000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1697 ms
Making predictions
..........
Predictions made
Waited 0.3255 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1.5
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.5000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.189 ms
Making predictions
..........
Predictions made
Waited 0.2594 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1.6
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.6000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1701 ms
Making predictions
..........
Predictions made
Waited 0.34 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1.7
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.7000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1781 ms
Making predictions
..........
Predictions made
Waited 0.2764 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1.8
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.8000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1831 ms
Making predictions
..........
Predictions made
Waited 0.2851 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1.9
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.9000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1925 ms
Making predictions
..........
Predictions made
Waited 0.2588 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 2
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 2.0000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1787 ms
Making predictions
..........
Predictions made
Waited 0.3228 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with x and its lag values
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2              .2         -.21253           1.633 
                 2              .3         -.21253           1.633 
                 2              .4         -.21253           1.633 
                 2              .5         -.21253           1.633 
                 2              .6         -.21253           1.633 
                 2              .7         -.21253           1.633 
                 2              .8         -.21253           1.633 
                 2              .9         -.21253           1.633 
                 2               1         -.21253           1.633 
                 2             1.1         -.21253           1.633 
                 2             1.2         -.21253           1.633 
                 2             1.3         -.21253           1.633 
                 2             1.4         -.21253           1.633 
                 2             1.5         -.21253           1.633 
                 2             1.6         -.21253           1.633 
                 2             1.7         -.21253           1.633 
                 2             1.8         -.21253           1.633 
                 2             1.9         -.21253           1.633 
                 2               2         -.21253           1.633 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+2
Note: Random 50/50 split for training and validation data

. 
. edm xmap x y, theta(0.2) algorithm(smap) savesmap(beta)

====================
Start of the plugin

number of vars & obs = 10, 201
first and last obs in sample = 1, 201

arg 0: .2
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 1
arg 8: 3
arg 9: 4
arg 10: 1

theta = 0.2000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 200
predict set obs: 200

p_manifold flag = false

l = 4

columns in smap coefficients = 3
save_mode = true

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.4163 ms
Making predictions
..........
Predictions made
Waited 0.4818 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 10, 201
first and last obs in sample = 1, 201

arg 0: .2
arg 1: 4
arg 2: smap
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 1
arg 8: 3
arg 9: 4
arg 10: 1

theta = 0.2000

algorithm = smap

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 200
predict set obs: 200

p_manifold flag = false

l = 4

columns in smap coefficients = 3
save_mode = true

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.4048 ms
Making predictions
..........
Predictions made
Waited 0.3899 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables x and y
---------------------------------------------------------------
      Mapping    Library size             rho             MAE
---------------------------------------------------------------
   y ~ y|M(x)             200         -.12941          1.6812 
   x ~ x|M(y)             200        -.018766          1.5675 
---------------------------------------------------------------
Note: The embedding dimension E is 2

. assert beta1_b2_rep1 !=. if _n>1

. 
. edm xmap y x, predict(x2) direction(oneway)

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 200
predict set obs: 200

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.5376 ms
Making predictions
..........
Predictions made
Waited 0.6642 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables y and x
---------------------------------------------------------------
      Mapping    Library size             rho             MAE
---------------------------------------------------------------
   x ~ x|M(y)             200          .94272         .048213 
---------------------------------------------------------------
Note: The embedding dimension E is 2

. assert x2 !=. if _n>1

. 
. edm explore x, copredict(teste) copredictvar(y)

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.2168 ms
Making predictions
..........
Predictions made
Waited 0.1602 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 9, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 1
arg 7: 0
arg 8: 2
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 199
predict set obs: 200

p_manifold flag = true
number of variables in p_manifold = 2

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.4756 ms
Making predictions
..........
Predictions made
Waited 0.4016 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with x and its lag values
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1          .99902        .0065958 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Random 50/50 split for training and validation data

. assert teste!=. if _n>1

. 
. edm explore z.x, tp(10)

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 95
predict set obs: 95

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.5 ms
Making predictions
...........
Predictions made
Waited 0.2326 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with z.x and its lag values
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1           .9163          .32768 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Random 50/50 split for training and validation data

. 
. edm xmap y x, tp(10) direction(oneway)

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 190
predict set obs: 190

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.4707 ms
Making predictions
..........
Predictions made
Waited 0.1984 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables y and x
---------------------------------------------------------------
      Mapping    Library size             rho             MAE
---------------------------------------------------------------
   x ~ x|M(y)             190          .89554         .068441 
---------------------------------------------------------------
Note: The embedding dimension E is 2

. 
. edm xmap y x, tp(10) copredict(testx) copredictvar(x2 y) direction(oneway)

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 190
predict set obs: 190

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.4319 ms
Making predictions
..........
Predictions made
Waited 0.3728 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 9, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 1
arg 7: 0
arg 8: 2
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 190
predict set obs: 199

p_manifold flag = true
number of variables in p_manifold = 2

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.3695 ms
Making predictions
...........
Predictions made
Waited 0.3689 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables y and x
---------------------------------------------------------------
      Mapping    Library size             rho             MAE
---------------------------------------------------------------
   x ~ x|M(y)             190          .89554         .068441 
---------------------------------------------------------------
Note: The embedding dimension E is 2

. assert testx!=. if _n>2

. 
. edm xmap y x, tp(10) copredict(testx2) copredictvar(z.x2 z.y) direction(oneway)

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 190
predict set obs: 190

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.3887 ms
Making predictions
..........
Predictions made
Waited 0.3576 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 9, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 1
arg 7: 0
arg 8: 2
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 190
predict set obs: 199

p_manifold flag = true
number of variables in p_manifold = 2

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.3756 ms
Making predictions
...........
Predictions made
Waited 0.2745 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables y and x
---------------------------------------------------------------
      Mapping    Library size             rho             MAE
---------------------------------------------------------------
   x ~ x|M(y)             190          .89554         .068441 
---------------------------------------------------------------
Note: The embedding dimension E is 2

. assert testx2 !=. if _n>2

. 
. edm xmap y x, extra(u1) tp(10) copredict(testx3) copredictvar(z.x2 z.y) direction(oneway)

====================
Start of the plugin

number of vars & obs = 8, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 4
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 3
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 3

train set obs: 190
predict set obs: 190

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.4484 ms
Making predictions
..........
Predictions made
Waited 0.314 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 11, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 4
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 3
arg 6: 1
arg 7: 0
arg 8: 3
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 3

train set obs: 190
predict set obs: 199

p_manifold flag = true
number of variables in p_manifold = 3

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.4855 ms
Making predictions
...........
Predictions made
Waited 0.2832 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables y and x
Additional variable in the embedding: u1
---------------------------------------------------------------
      Mapping    Library size             rho             MAE
---------------------------------------------------------------
   x ~ x|M(y)             190          .37011          .16613 
---------------------------------------------------------------
Note: The embedding dimension E is 3 (including 1 extra)

. assert testx3 !=. if _n>2

. 
. * check explore / xmap consistency
. 
. edm xmap l.x x, direction(oneway)

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 199
predict set obs: 199

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.5759 ms
Making predictions
...........
Predictions made
Waited 0.2847 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables l.x and x
-------------------------------------------------------------------
          Mapping    Library size             rho             MAE
-------------------------------------------------------------------
     x ~ x|M(l.x)             199          .99939        .0049147 
-------------------------------------------------------------------
Note: The embedding dimension E is 2

. mat xmap_r=e(b)

. edm explore x, full

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 199
predict set obs: 199

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.4695 ms
Making predictions
...........
Predictions made
Waited 0.3517 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with x and its lag values
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1          .99939        .0049147 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Full sample used for the computation

. mat explore_r =e(b)

. assert xmap_r[1,1] == explore_r[1,1]

. 
. * check xmap reverse consistency
. 
. edm xmap x y

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 200
predict set obs: 200

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.4733 ms
Making predictions
..........
Predictions made
Waited 0.2713 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 200
predict set obs: 200

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.4433 ms
Making predictions
..........
Predictions made
Waited 0.2131 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables x and y
---------------------------------------------------------------
      Mapping    Library size             rho             MAE
---------------------------------------------------------------
   y ~ y|M(x)             200          .54213          .13182 
   x ~ x|M(y)             200          .94272         .048213 
---------------------------------------------------------------
Note: The embedding dimension E is 2

. mat xmap1 = e(b)

. edm xmap y x

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 200
predict set obs: 200

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.4103 ms
Making predictions
..........
Predictions made
Waited 0.2737 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 200
predict set obs: 200

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.3846 ms
Making predictions
..........
Predictions made
Waited 0.2275 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables y and x
---------------------------------------------------------------
      Mapping    Library size             rho             MAE
---------------------------------------------------------------
   x ~ x|M(y)             200          .94272         .048213 
   y ~ y|M(x)             200          .54213          .13182 
---------------------------------------------------------------
Note: The embedding dimension E is 2

. * TODO: Fix the following asserts, which are considered syntax errors in Stata15 (on Mac).
. * assert e(b)[1,1] == xmap1[1,2]
. * assert e(b)[1,2] == xmap1[1,1]
. 
. tempfile basedata

. qui compress

. qui save `basedata', replace

. * test missing data
. set seed 12345678

. gen double u = runiform()

. drop if u<0.1
(19 observations deleted)

. replace x = . if u<0.2
(22 real changes made, 22 to missing)

. replace t=. if mod(t,19) ==1
(11 real changes made, 11 to missing)

. 
. edm explore x

====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1659 ms
Making predictions
.............
Predictions made
Waited 0.2771 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with x and its lag values
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1          .99627          .01523 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Random 50/50 split for training and validation data

. edm explore x, dt

====================
Start of the plugin

number of vars & obs = 8, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 4
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 3
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 3

train set obs: 74
predict set obs: 74

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2657 ms
Making predictions
...........
Predictions made
Waited 0.1462 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Multivariate mapping with x and its lag values
Additional variables in the embedding: (time delta)
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 3               1          .58186          .13183 
--------------------------------------------------------------------
Note: Actual E is higher than the specified E due to extras
Note: Number of neighbours (k) is set to E+2
Note: Random 50/50 split for training and validation data
Note: Embedding includes the delta of the time variable with a weight of .36

. 
. edm explore x, allowmissing

====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: .247341863143735
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.247342

number of variables in manifold = 2

train set obs: 59
predict set obs: 59

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
............
Distances calculated
Waited 0.1804 ms
Making predictions
............
Predictions made
Waited 0.1372 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with x and its lag values
Missing values are assumed to have a distance of .25 with all values.
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1          .99682         .011804 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Random 50/50 split for training and validation data

. edm explore x, missingdistance(2)

====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 2
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 2.000000

number of variables in manifold = 2

train set obs: 59
predict set obs: 59

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
............
Distances calculated
Waited 0.1487 ms
Making predictions
............
Predictions made
Waited 0.1548 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with x and its lag values
Missing values are assumed to have a distance of 2 with all values.
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1          .99531          .01599 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Random 50/50 split for training and validation data

. edm xmap x l.x, allowmissing

====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: .247341863143735
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.247342

number of variables in manifold = 2

train set obs: 124
predict set obs: 124

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.3609 ms
Making predictions
...........
Predictions made
Waited 0.2883 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: .247341863143735
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.247342

number of variables in manifold = 2

train set obs: 118
predict set obs: 118

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.259 ms
Making predictions
...........
Predictions made
Waited 0.2804 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables x and l.x
Missing values are assumed to have a distance of .25 with all values.
-------------------------------------------------------------------
          Mapping    Library size             rho             MAE
-------------------------------------------------------------------
   l.x ~ l.x|M(x)             124           .9998        .0027684 
     x ~ x|M(l.x)             118           .9983        .0093729 
-------------------------------------------------------------------
Note: The embedding dimension E is 2

. edm xmap x l.x, missingdistance(2)

====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 2
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 2.000000

number of variables in manifold = 2

train set obs: 124
predict set obs: 124

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.212 ms
Making predictions
...........
Predictions made
Waited 0.2512 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 2
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 2.000000

number of variables in manifold = 2

train set obs: 118
predict set obs: 118

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1913 ms
Making predictions
...........
Predictions made
Waited 0.2698 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables x and l.x
Missing values are assumed to have a distance of 2 with all values.
-------------------------------------------------------------------
          Mapping    Library size             rho             MAE
-------------------------------------------------------------------
   l.x ~ l.x|M(x)             124           .9998        .0027686 
     x ~ x|M(l.x)             118           .9983        .0093764 
-------------------------------------------------------------------
Note: The embedding dimension E is 2

. 
. edm xmap x l.x, extraembed(u) allowmissing dt alg(smap) savesmap(newb) e(5)

====================
Start of the plugin

number of vars & obs = 26, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 9
arg 2: smap
arg 3: 
arg 4: .247341863143735
arg 5: 10
arg 6: 0
arg 7: 1
arg 8: 11
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = smap

force compute = false

missing distance = 0.247342

number of variables in manifold = 10

train set obs: 124
predict set obs: 124

p_manifold flag = false

l = 9

columns in smap coefficients = 11
save_mode = true

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.5439 ms
Making predictions
...........
Predictions made
Waited 0.3486 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 26, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 9
arg 2: smap
arg 3: 
arg 4: .247341863143735
arg 5: 10
arg 6: 0
arg 7: 1
arg 8: 11
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = smap

force compute = false

missing distance = 0.247342

number of variables in manifold = 10

train set obs: 150
predict set obs: 150

p_manifold flag = false

l = 9

columns in smap coefficients = 11
save_mode = true

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.9527 ms
Making predictions
..........
Predictions made
Waited 0.3184 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables x and l.x
Additional variables in the embedding: u (+ time delta)
Missing values are assumed to have a distance of .25 with all values.
-------------------------------------------------------------------
          Mapping    Library size             rho             MAE
-------------------------------------------------------------------
   l.x ~ l.x|M(x)             124        -.064178          6.2268 
     x ~ x|M(l.x)             150        -.073966          5.6921 
-------------------------------------------------------------------
Note: The embedding dimension E is 10 (including 5 extras)
Note: Embedding includes the delta of the time variable with a weight of .55 and .54

. 
. edm xmap x l3.x, extraembed(u) allowmissing dt alg(smap) savesmap(newc) e(5) oneway dtsave(testdt)

====================
Start of the plugin

number of vars & obs = 26, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 9
arg 2: smap
arg 3: 
arg 4: .247341863143735
arg 5: 10
arg 6: 0
arg 7: 1
arg 8: 11
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = smap

force compute = false

missing distance = 0.247342

number of variables in manifold = 10

train set obs: 123
predict set obs: 123

p_manifold flag = false

l = 9

columns in smap coefficients = 11
save_mode = true

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.5442 ms
Making predictions
...........
Predictions made
Waited 0.3468 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables x and l3.x
Additional variables in the embedding: u (+ time delta)
Missing values are assumed to have a distance of .25 with all values.
---------------------------------------------------------------------
            Mapping    Library size             rho             MAE
---------------------------------------------------------------------
   l3.x ~ l3.x|M(x)             123        -.052477          6.2964 
---------------------------------------------------------------------
Note: The embedding dimension E is 10 (including 5 extras)
Note: Embedding includes the delta of the time variable with a weight of .55

. 
. edm explore x, extraembed(u) allowmissing dt crossfold(5)
5-fold cross-validation progress (5 in total)

====================
Start of the plugin

number of vars & obs = 9, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: .247341863143735
arg 5: 4
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.247342

number of variables in manifold = 4

train set obs: 120
predict set obs: 29

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...............
Distances calculated
Waited 0.1587 ms
Making predictions
...............
Predictions made
Waited 0.1313 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 9, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: .247341863143735
arg 5: 4
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.247342

number of variables in manifold = 4

train set obs: 119
predict set obs: 30

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.202 ms
Making predictions
..........
Predictions made
Waited 0.1778 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 9, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: .247341863143735
arg 5: 4
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.247342

number of variables in manifold = 4

train set obs: 119
predict set obs: 30

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.138 ms
Making predictions
..........
Predictions made
Waited 0.2297 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 9, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: .247341863143735
arg 5: 4
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.247342

number of variables in manifold = 4

train set obs: 119
predict set obs: 30

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.127 ms
Making predictions
..........
Predictions made
Waited 0.2667 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 9, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 5
arg 2: simplex
arg 3: 
arg 4: .247341863143735
arg 5: 4
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.247342

number of variables in manifold = 4

train set obs: 119
predict set obs: 30

p_manifold flag = false

l = 5

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1236 ms
Making predictions
..........
Predictions made
Waited 0.137 ms
Saving predictions

End of the plugin
====================

.

Empirical Dynamic Modelling
Multivariate mapping with x and its lag values
Additional variables in the embedding: u (+ time delta)
Missing values are assumed to have a distance of .25 with all values.
----------------------------------------------------------------------
                      --------- rho ---------  --------- MAE ---------
 Actual E    theta         Mean    Std. Dev.         Mean    Std. Dev.
----------------------------------------------------------------------
        4        1       .62918      .085112       .12219      .020361
----------------------------------------------------------------------
Note: Results from 5 runs
Note: Actual E is higher than the specified E due to extras
Note: Number of neighbours (k) is set to E+3
Note: 5-fold cross validation results reported
Note: Embedding includes the delta of the time variable with a weight of .55

. 
. edm explore d.x, dt

====================
Start of the plugin

number of vars & obs = 8, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 4
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 3
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 3

train set obs: 53
predict set obs: 53

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.454 ms
Making predictions
...........
Predictions made
Waited 0.1218 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Multivariate mapping with d.x and its lag values
Additional variables in the embedding: (time delta)
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 3               1          .78058          .15644 
--------------------------------------------------------------------
Note: Actual E is higher than the specified E due to extras
Note: Number of neighbours (k) is set to E+2
Note: Random 50/50 split for training and validation data
Note: Embedding includes the delta of the time variable with a weight of .27

. 
. edm explore x, rep(20) ci(95)
Replication progress (20 in total)

====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1043 ms
Making predictions
.............
Predictions made
Waited 0.2538 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1064 ms
Making predictions
.............
Predictions made
Waited 0.2483 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.102 ms
Making predictions
.............
Predictions made
Waited 0.2259 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1006 ms
Making predictions
.............
Predictions made
Waited 0.0935 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1058 ms
Making predictions
.............
Predictions made
Waited 0.0952 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1037 ms
Making predictions
.............
Predictions made
Waited 0.2536 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1198 ms
Making predictions
.............
Predictions made
Waited 0.1855 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1251 ms
Making predictions
.............
Predictions made
Waited 0.1229 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.0964 ms
Making predictions
.............
Predictions made
Waited 0.1326 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1441 ms
Making predictions
.............
Predictions made
Waited 0.1143 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1087 ms
Making predictions
.............
Predictions made
Waited 0.1366 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1116 ms
Making predictions
.............
Predictions made
Waited 0.1311 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1005 ms
Making predictions
.............
Predictions made
Waited 0.1168 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.0941 ms
Making predictions
.............
Predictions made
Waited 0.1841 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1109 ms
Making predictions
.............
Predictions made
Waited 0.0848 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1242 ms
Making predictions
.............
Predictions made
Waited 0.1485 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.2643 ms
Making predictions
.............
Predictions made
Waited 0.1117 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.3499 ms
Making predictions
.............
Predictions made
Waited 0.1716 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1068 ms
Making predictions
.............
Predictions made
Waited 0.3361 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 38
predict set obs: 39

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
.............
Distances calculated
Waited 0.1066 ms
Making predictions
.............
Predictions made
Waited 0.2569 ms
Saving predictions

End of the plugin
====================

.

Empirical Dynamic Modelling
Univariate mapping with x and its lag values
----------------------------------------------------------------------
                      --------- rho ---------  --------- MAE ---------
 Actual E    theta         Mean    Std. Dev.         Mean    Std. Dev.
----------------------------------------------------------------------
        2        1       .99571     .0045792      .013297     .0039025
  Est. mean 95% CI   [   .99357,    .99785 ]   [   .01147,   .015123 ]
2.5/97.5 Pc (Est.)   [   .98673,    1.0047 ]   [ .0056481,   .020946 ]
2.5/97.5 Pc (Obs.)   [   .98346,    .99887 ]   [ .0085166,   .024075 ]
----------------------------------------------------------------------
Note: Results from 20 runs
Note: Number of neighbours (k) is set to E+1
Note: Random 50/50 split for training and validation data

. 
. edm xmap x y, lib(50) rep(20) ci(95)
Replication progress (40 in total)

====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2129 ms
Making predictions
...........
Predictions made
Waited 0.2742 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.3326 ms
Making predictions
...........
Predictions made
Waited 0.1455 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1741 ms
Making predictions
...........
Predictions made
Waited 0.1609 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1717 ms
Making predictions
...........
Predictions made
Waited 0.1532 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2258 ms
Making predictions
...........
Predictions made
Waited 0.1587 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1972 ms
Making predictions
...........
Predictions made
Waited 0.2636 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1828 ms
Making predictions
...........
Predictions made
Waited 0.1716 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2653 ms
Making predictions
...........
Predictions made
Waited 0.171 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1612 ms
Making predictions
...........
Predictions made
Waited 0.255 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1888 ms
Making predictions
...........
Predictions made
Waited 0.3165 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1648 ms
Making predictions
...........
Predictions made
Waited 0.2365 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2718 ms
Making predictions
...........
Predictions made
Waited 0.1818 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.3355 ms
Making predictions
...........
Predictions made
Waited 0.2497 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.171 ms
Making predictions
...........
Predictions made
Waited 0.246 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1623 ms
Making predictions
...........
Predictions made
Waited 0.2532 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2204 ms
Making predictions
...........
Predictions made
Waited 0.2407 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1593 ms
Making predictions
...........
Predictions made
Waited 0.1638 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2015 ms
Making predictions
...........
Predictions made
Waited 0.2192 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2318 ms
Making predictions
...........
Predictions made
Waited 0.2571 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 108

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2285 ms
Making predictions
...........
Predictions made
Waited 0.1717 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.259 ms
Making predictions
...........
Predictions made
Waited 0.2666 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1918 ms
Making predictions
...........
Predictions made
Waited 0.2684 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2353 ms
Making predictions
...........
Predictions made
Waited 0.2577 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2532 ms
Making predictions
...........
Predictions made
Waited 0.1835 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1937 ms
Making predictions
...........
Predictions made
Waited 0.2709 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.185 ms
Making predictions
...........
Predictions made
Waited 0.1675 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1846 ms
Making predictions
...........
Predictions made
Waited 0.2345 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1812 ms
Making predictions
...........
Predictions made
Waited 0.2112 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1676 ms
Making predictions
...........
Predictions made
Waited 0.2509 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2076 ms
Making predictions
...........
Predictions made
Waited 0.1896 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2174 ms
Making predictions
...........
Predictions made
Waited 0.4465 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1921 ms
Making predictions
...........
Predictions made
Waited 0.1998 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1805 ms
Making predictions
...........
Predictions made
Waited 0.2564 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2106 ms
Making predictions
...........
Predictions made
Waited 0.2167 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.4627 ms
Making predictions
...........
Predictions made
Waited 0.2192 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2201 ms
Making predictions
...........
Predictions made
Waited 0.1807 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1744 ms
Making predictions
...........
Predictions made
Waited 0.2 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.211 ms
Making predictions
...........
Predictions made
Waited 0.2522 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.2079 ms
Making predictions
...........
Predictions made
Waited 0.2465 ms
Saving predictions

End of the plugin
====================

.
====================
Start of the plugin

number of vars & obs = 7, 182
first and last obs in sample = 1, 182

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 50
predict set obs: 123

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.1957 ms
Making predictions
...........
Predictions made
Waited 0.2168 ms
Saving predictions

End of the plugin
====================

.

Empirical Dynamic Modelling
Convergent Cross-mapping result for variables x and y
---------------------------------------------------------------
      Mapping        Lib size        Mean rho       Std. Dev.
---------------------------------------------------------------
   y ~ y|M(x)              50          .37281         .068293
  Est. mean 95% CI                    [   .34085,    .40477 ]
2.5/97.5 Pc (Est.)                    [   .23896,    .50666 ]
2.5/97.5 Pc (Obs.)                    [   .25678,    .49079 ]
   x ~ x|M(y)              50          .86316         .024202
  Est. mean 95% CI                    [   .85183,    .87448 ]
2.5/97.5 Pc (Est.)                    [   .81572,    .91059 ]
2.5/97.5 Pc (Obs.)                    [   .80334,    .89799 ]
---------------------------------------------------------------
Note: Results from 20 replications
Note: The embedding dimension E is 2

. 
. use `basedata', clear

. cap drop x_copy

. cap drop x_p

. cap drop xc_p

. clonevar x_copy = x

. edm explore x, predict(x_p) copredict(xc_p) copredictvar(x_copy) full

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 199
predict set obs: 199

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.5682 ms
Making predictions
...........
Predictions made
Waited 0.2637 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 9, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 1
arg 7: 0
arg 8: 2
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 199
predict set obs: 200

p_manifold flag = true
number of variables in p_manifold = 2

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.3687 ms
Making predictions
..........
Predictions made
Waited 0.3636 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with x and its lag values
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1          .99939        .0049147 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Full sample used for the computation

. assert x_p!=. if _n!=1 & _n!=_N

. assert xc_p!=. if _n!=1 & _n!=_N

. assert x_p ==xc_p if x_p!=.

. cor x_p f.x
(obs=199)

             |                 F.
             |      x_p        x
-------------+------------------
         x_p |   1.0000
           x |
         F1. |   0.9994   1.0000


. cor xc_p f.x
(obs=199)

             |                 F.
             |     xc_p        x
-------------+------------------
        xc_p |   1.0000
           x |
         F1. |   0.9994   1.0000


. 
. cap drop x_p xc_p

. edm explore x, predict(x_p) copredict(xc_p) copredictvar(x_copy) full tp(2)

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 198
predict set obs: 198

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.4975 ms
Making predictions
...........
Predictions made
Waited 0.2569 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 9, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 1
arg 7: 0
arg 8: 2
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 198
predict set obs: 200

p_manifold flag = true
number of variables in p_manifold = 2

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.404 ms
Making predictions
..........
Predictions made
Waited 0.4278 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with x and its lag values
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1          .99877        .0078776 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Full sample used for the computation

. sum x_p xc_p

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         x_p |        198    .6434232    .2159587   .3039276   .8967989
        xc_p |        200    .6436226    .2154685   .3039276   .8967989

. assert xc_p!=. if x_p!=.

. 
. gen y_copy = y

. edm xmap x y, tp(10) copredict(xmap_y_p) copredictvar(x_copy y_copy) direction(oneway) predict(xmap_y)

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 190
predict set obs: 190

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.4666 ms
Making predictions
..........
Predictions made
Waited 0.2392 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 9, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 1
arg 7: 0
arg 8: 2
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 190
predict set obs: 200

p_manifold flag = true
number of variables in p_manifold = 2

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.3782 ms
Making predictions
..........
Predictions made
Waited 0.558 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables x and y
---------------------------------------------------------------
      Mapping    Library size             rho             MAE
---------------------------------------------------------------
   y ~ y|M(x)             190          .30665          .15441 
---------------------------------------------------------------
Note: The embedding dimension E is 2

. assert xmap_y_p !=. if _n>1

. assert xmap_y_p == xmap_y if xmap_y !=.

. 
. preserve

. drop if mod(t,17)==1
(12 observations deleted)

. //copredict with dt
. edm xmap x y, dt copredict(xmap_y_p_dt) copredictvar(x_copy y_copy) direction(oneway) predict(xmap_y_dt)

====================
Start of the plugin

number of vars & obs = 8, 189
first and last obs in sample = 1, 189

arg 0: 1
arg 1: 4
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 3
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 3

train set obs: 188
predict set obs: 188

p_manifold flag = false

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.4558 ms
Making predictions
...........
Predictions made
Waited 0.2848 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 11, 189
first and last obs in sample = 1, 189

arg 0: 1
arg 1: 4
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 3
arg 6: 1
arg 7: 0
arg 8: 3
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 3

train set obs: 188
predict set obs: 188

p_manifold flag = true
number of variables in p_manifold = 3

l = 4

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.4342 ms
Making predictions
...........
Predictions made
Waited 0.2591 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Convergent Cross-mapping result for variables x and y
Additional variables in the embedding: (time delta)
---------------------------------------------------------------
      Mapping    Library size             rho             MAE
---------------------------------------------------------------
   y ~ y|M(x)             188          .51527          .13499 
---------------------------------------------------------------
Note: The embedding dimension E is 3 (including 1 extra)
Note: Embedding includes the delta of the time variable with a weight of .88

. assert xmap_y_p_dt !=. if _n>1

. assert xmap_y_p_dt == xmap_y_dt if xmap_y_dt !=.

. 
. edm explore x, predict(predicted_x_dt) copredict(predicted_x_copy_dt) copredictvar(x_copy) full

====================
Start of the plugin

number of vars & obs = 7, 189
first and last obs in sample = 1, 189

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 163
predict set obs: 163

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.3698 ms
Making predictions
...........
Predictions made
Waited 0.3698 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 9, 189
first and last obs in sample = 1, 189

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 1
arg 7: 0
arg 8: 2
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 163
predict set obs: 176

p_manifold flag = true
number of variables in p_manifold = 2

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.3051 ms
Making predictions
...........
Predictions made
Waited 0.3587 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with x and its lag values
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1          .99928        .0054303 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Full sample used for the computation

. 
. assert predicted_x_dt == predicted_x_copy_dt if predicted_x_dt!=.

. 
. restore

. 
. edm explore x, copredict(dx2) copredictvar(d.x)

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 99
predict set obs: 100

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.1843 ms
Making predictions
..........
Predictions made
Waited 0.1568 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 9, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 1
arg 7: 0
arg 8: 2
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 199
predict set obs: 199

p_manifold flag = true
number of variables in p_manifold = 2

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.3538 ms
Making predictions
...........
Predictions made
Waited 0.2637 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with x and its lag values
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1          .99847        .0089172 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Random 50/50 split for training and validation data

. 
. edm explore x, predict(predicted_x) copredict(predicted_y_from_mx) copredictvar(y) full

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 199
predict set obs: 199

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.3949 ms
Making predictions
...........
Predictions made
Waited 0.3597 ms
Saving predictions

End of the plugin
====================


====================
Start of the plugin

number of vars & obs = 9, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 1
arg 7: 0
arg 8: 2
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 199
predict set obs: 200

p_manifold flag = true
number of variables in p_manifold = 2

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
..........
Distances calculated
Waited 0.3881 ms
Making predictions
..........
Predictions made
Waited 0.4379 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with x and its lag values
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1          .99939        .0049147 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Full sample used for the computation

. edm explore y, predict(predicted_y) full

====================
Start of the plugin

number of vars & obs = 7, 201
first and last obs in sample = 1, 201

arg 0: 1
arg 1: 3
arg 2: simplex
arg 3: 
arg 4: 0
arg 5: 2
arg 6: 0
arg 7: 0
arg 8: 0
arg 9: 4
arg 10: 1

theta = 1.0000

algorithm = simplex

force compute = false

missing distance = 0.000000

number of variables in manifold = 2

train set obs: 199
predict set obs: 199

p_manifold flag = false

l = 3

save_mode = false

Requested 4 threads
Using 4 threads

Eigen has 1 threads
Calculating distances
...........
Distances calculated
Waited 0.5656 ms
Making predictions
...........
Predictions made
Waited 0.6899 ms
Saving predictions

End of the plugin
====================


Empirical Dynamic Modelling
Univariate mapping with y and its lag values
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1          .99279          .01359 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Full sample used for the computation

. cor f.x f.y predicted_x predicted_y predicted_y_from_mx
(obs=199)

             |        F.       F.                           
             |        x        y predi~_x predic~y predi~mx
-------------+---------------------------------------------
           x |
         F1. |   1.0000
           y |
         F1. |   0.3545   1.0000
 predicted_x |   0.9994   0.3467   1.0000
 predicted_y |   0.3618   0.9928   0.3540   1.0000
predicted~mx |   0.1334   0.7831   0.1217   0.7850   1.0000


. cor f.x predicted_x
(obs=199)

             |        F.         
             |        x predi~_x
-------------+------------------
           x |
         F1. |   1.0000
 predicted_x |   0.9994   1.0000


. assert r(rho)>0.99

. cor f.y predicted_y
(obs=199)

             |        F.         
             |        y predic~y
-------------+------------------
           y |
         F1. |   1.0000
 predicted_y |   0.9928   1.0000


. assert r(rho)>0.99

. cor f.y predicted_y_from_mx
(obs=199)

             |        F.         
             |        y predi~mx
-------------+------------------
           y |
         F1. |   1.0000
predicted~mx |   0.7831   1.0000


. assert r(rho)>0.7

. 
. * Obtaining CI of the xmap
. jackknife: edm xmap x y, e(2)
(running edm on estimation sample)

Jackknife replications (200)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
..................................................   100
..................................................   150
..................................................   200

Empirical Dynamic Modelling
Convergent Cross-mapping result for variables x and y
---------------------------------------------------------------
      Mapping    Library size             rho             MAE
---------------------------------------------------------------
   y ~ y|M(x)             200          .54213          .13182 
   x ~ x|M(y)             200          .94272         .048213 
---------------------------------------------------------------
Note: The embedding dimension E is 2

. ereturn display
------------------------------------------------------------------------------
             |              Jackknife
             |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      y|M(x) |    .542135   .0914957     5.93   0.000     .3617095    .7225605
      x|M(y) |   .9427227   .0140109    67.29   0.000     .9150939    .9703515
------------------------------------------------------------------------------

. 
. jackknife: edm explore x, e(2)
(running edm on estimation sample)

Jackknife replications (199)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
..................................................   100
..................................................   150
.................................................

Empirical Dynamic Modelling
Univariate mapping with x and its lag values
--------------------------------------------------------------------
          Actual E           theta             rho             MAE
--------------------------------------------------------------------
                 2               1          .99846        .0083042 
--------------------------------------------------------------------
Note: Number of neighbours (k) is set to E+1
Note: Random 50/50 split for training and validation data

. ereturn display
------------------------------------------------------------------------------
             |              Jackknife
             |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
           x |   .9984628   .0106503    93.75   0.000     .9774601    1.019465
------------------------------------------------------------------------------

. 
end of do-file
